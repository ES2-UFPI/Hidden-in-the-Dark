!function(e){var t={};function s(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=1)}([function(e){e.exports=JSON.parse('[{"x":"725","y":"1645"},{"x":"2253","y":"1812"},{"x":"3473","y":"1812"},{"x":"4297","y":"1952"},{"x":"4141","y":"2750"},{"x":"4297","y":"3881"},{"x":"3465","y":"3469"},{"x":"3205","y":"4363"},{"x":"1653","y":"2641"},{"x":"3677","y":"4459"},{"x":"2401","y":"2383"}]')},function(e,t,s){"use strict";s.r(t);class i{constructor(e,t,s){this.game=e,this.id=t,this.name="player_"+t,this.caminho="./src/assets/players/player_"+t+".png",this.velocidade=s,this.player=void 0,this.prevVelocity=void 0,this.prevDir="l"}preload(){this.game.load.spritesheet(this.name,this.caminho,{frameWidth:16,frameHeight:24})}create(e,t){this.player=this.game.physics.add.sprite(e,t,this.name),this.player.depth=10;const s=this.game.anims;s.create({key:"leftWalk",frames:s.generateFrameNames(this.name,{start:19,end:16}),frameRate:10,repeat:-1}),s.create({key:"rightWalk",frames:s.generateFrameNames(this.name,{start:12,end:15}),frameRate:10,repeat:-1}),s.create({key:"leftIdle",frames:s.generateFrameNames(this.name,{start:8,end:11}),frameRate:10,repeat:-1}),s.create({key:"rightIdle",frames:s.generateFrameNames(this.name,{start:4,end:7}),frameRate:10,repeat:-1}),this.player.anims.play("rightIdle",!0)}update(e){this.prevVelocity=this.player.body.velocity.clone(),this.prevDir=this.player.anims.currentAnim.key.toString()[0],this.player.body.setVelocity(0);var t=Math.sqrt(this.velocidade**2*2)/2;e.left.isDown&&e.down.isDown?(this.player.body.setVelocityX(-t),this.player.body.setVelocityY(t)):e.left.isDown&&e.up.isDown?(this.player.body.setVelocityX(-t),this.player.body.setVelocityY(-t)):e.right.isDown&&e.down.isDown?(this.player.body.setVelocityX(t),this.player.body.setVelocityY(t)):e.right.isDown&&e.up.isDown?(this.player.body.setVelocityX(t),this.player.body.setVelocityY(-t)):e.left.isDown?this.player.body.setVelocityX(-this.velocidade):e.right.isDown?this.player.body.setVelocityX(this.velocidade):e.up.isDown?this.player.body.setVelocityY(-this.velocidade):e.down.isDown&&this.player.body.setVelocityY(this.velocidade),e.left.isDown?this.player.anims.play("leftWalk",!0):e.right.isDown?this.player.anims.play("rightWalk",!0):e.up.isDown||e.down.isDown?"l"==this.prevDir?this.player.anims.play("leftWalk",!0):this.player.anims.play("rightWalk",!0):(this.prevVelocity.x<0?this.player.anims.play("leftIdle",!0):this.prevVelocity.x>0?this.player.anims.play("rightIdle",!0):(this.prevVelocity.y<0||this.prevVelocity.y>0)&&("l"==this.prevDir?this.player.anims.play("leftIdle",!0):this.player.anims.play("rightIdle",!0)),"l"==this.prevDir?this.player.anims.play("leftIdle",!0):this.player.anims.play("rightIdle",!0))}interactions(e){}}class a extends i{constructor(e,t,s){super(e,t,s),this.lastChest=null,this.abrindo=!1}interactions(e){super.interactions(e),this.circularProgress=void 0,e.forEach(e=>{this.game.physics.add.overlap(this.player,e.zone,()=>{this.lastChest=e})})}preload(){this.game.load.plugin("rexcircularprogressplugin","https://raw.githubusercontent.com/rexrainbow/phaser3-rex-notes/master/dist/rexcircularprogressplugin.min.js",!0),super.preload()}update(e){if(e.space.isDown){if(this.abrindo)return"l"==this.prevDir?this.player.anims.play("leftIdle",!0):this.player.anims.play("rightIdle",!0),void this.player.body.setVelocity(0);if(null!=this.lastChest&&this.game.physics.overlap(this.player,this.lastChest.zone)&&!this.abrindo&&!this.lastChest.is_open)return this.circularProgress=this.game.add.rexCircularProgress({x:570,y:420,radius:20,trackColor:2493956,barColor:8085079,centerColor:5125166,value:0,valuechangeCallback:(e,t,s)=>{1==e&&this.abrirBau()}}),this.game.tweens.add({targets:this.circularProgress,value:1,duration:1e3}),this.circularProgress.setScrollFactor(0,0),this.abrindo=!0,this.player.anims.play("leftIdle",!0),void this.player.body.setVelocity(0)}else this.abrindo&&(this.circularProgress.destroy(),this.abrindo=!1);super.update(e)}abrirBau(){null!=this.lastChest&&(this.lastChest.open(),this.abrindo=!1,this.circularProgress.destroy())}}class r{constructor(e,t,s){this.game=e,this.id=t,this.coord=s,this.caminho="./src/assets/items/chest.png",this.name="chest-"+this.id,this.is_open=!1}preload(){this.game.load.image(this.name+"-zone","./src/assets/items/chest-zone.png"),this.game.load.spritesheet(this.name,this.caminho,{frameWidth:54,frameHeight:54})}create(){this.chest=this.game.physics.add.staticSprite(this.coord.x,this.coord.y,this.name),this.zone=this.game.physics.add.staticImage(this.coord.x,this.coord.y,this.name+"-zone"),this.zone.setVisible(!1);const e=this.game.anims;e.create({key:"close",frames:e.generateFrameNames(this.name,{start:77,end:77}),frameRate:10,repeat:-1}),e.create({key:"open",frames:e.generateFrameNames(this.name,{start:77,end:81}),frameRate:10}),this.chest.anims.play("close",!0)}open(){0==this.is_open&&(this.chest.anims.play("open",!0),this.is_open=!0,this.game.addKey())}}class l extends Phaser.Scene{constructor(){super(),this.keys=0;var e=s(0);!function(e){let t,s=e.length;for(;0!=s;)t=Math.floor(Math.random()*s),s--,[e[s],e[t]]=[e[t],e[s]]}(e),this.player=new a(this,2,200),this.chests=[];for(var t=0;t<10;t++)this.chests.push(new r(this,t,e[t]))}preload(){this.load.image("tiles","./src/assets/map/assetsmap.png"),this.load.tilemapTiledJSON("map","./src/assets/map/map.json"),this.player.preload()}create(){const e=this.make.tilemap({key:"map"}),t=e.addTilesetImage("assetsmap","tiles"),s=(e.createLayer("ground",t,0,0),e.createLayer("objectCollider",t,0,0));s.setCollisionByProperty({collider:!0}),this.player.create(1834,527),this.physics.add.collider(this.player.player,s);const i=this.cameras.main.setZoom(2);i.startFollow(this.player.player),i.setBounds(0,0,e.widthInPixels,e.heightInPixels),this.keysText=this.add.text(210,155,"keys: "+this.keys,{fontSize:"20px",fill:"#FFFFFF"}),this.keysText.setScrollFactor(0,0)}update(){this.keysText.setText("keys: "+this.keys);var e=this.input.keyboard.createCursorKeys();this.player.update(e)}addKey(){this.keys+=1}}const o={type:Phaser.WEBGL,parent:"Hidden-in-the-Dark",width:800,height:600,scene:[new l({key:"partida"})],physics:{default:"arcade",arcade:{gravity:{y:0}}}};new Phaser.Game(o)}]);